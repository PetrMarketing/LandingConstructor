<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PK Business - Конструктор</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
    <div class="builder-container">
        <!-- Top Toolbar -->
        <header class="toolbar">
            <div class="toolbar-left">
                <a href="admin.html" class="logo">
                    <i class="fas fa-folder"></i>
                    <span>Мои проекты</span>
                </a>
            </div>
            <div class="toolbar-center">
                <div class="viewport-switcher">
                    <button class="viewport-btn active" data-viewport="desktop" title="Десктоп">
                        <i class="fas fa-desktop"></i>
                    </button>
                    <button class="viewport-btn" data-viewport="tablet" title="Планшет">
                        <i class="fas fa-tablet-alt"></i>
                    </button>
                    <button class="viewport-btn" data-viewport="mobile" title="Мобильный">
                        <i class="fas fa-mobile-alt"></i>
                    </button>
                </div>
            </div>
            <div class="toolbar-right">
                <button class="toolbar-btn" id="undoBtn" title="Отменить">
                    <i class="fas fa-undo"></i>
                </button>
                <button class="toolbar-btn" id="redoBtn" title="Повторить">
                    <i class="fas fa-redo"></i>
                </button>
                <button class="toolbar-btn" id="aiGenerateBtn" title="AI генерация" style="background: linear-gradient(135deg, #f59e0b, #ea580c);">
                    <i class="fas fa-magic"></i>
                </button>
                <button class="toolbar-btn" id="themeBtn" title="Тема оформления">
                    <i class="fas fa-palette"></i>
                </button>
                <button class="toolbar-btn" id="seoBtn" title="SEO настройки">
                    <i class="fas fa-search"></i>
                </button>
                <button class="toolbar-btn" id="guidesBtn" title="Визуальные направляющие">
                    <i class="fas fa-border-all"></i>
                </button>
                <button class="toolbar-btn" id="previewBtn" title="Предпросмотр">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="toolbar-btn" id="codeBtn" title="Код">
                    <i class="fas fa-code"></i>
                </button>
                <button class="toolbar-btn primary" id="saveBtn">
                    <i class="fas fa-save"></i>
                    <span>Сохранить</span>
                </button>
                <div class="export-dropdown">
                    <button class="toolbar-btn success" id="exportBtn">
                        <i class="fas fa-download"></i>
                        <span>Экспорт</span>
                        <i class="fas fa-chevron-down" style="margin-left:5px;font-size:10px;"></i>
                    </button>
                    <div class="export-dropdown-menu" id="exportDropdownMenu">
                        <button class="export-option" id="exportHtmlBtn">
                            <i class="fas fa-file-code"></i>
                            <span>HTML файл</span>
                        </button>
                        <button class="export-option" id="exportZipBtn">
                            <i class="fas fa-file-archive"></i>
                            <span>ZIP архив</span>
                        </button>
                    </div>
                </div>
                <button class="toolbar-btn" id="publishBtn" style="background: linear-gradient(135deg, #8b5cf6, #6366f1);">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <span>Опубликовать</span>
                </button>
            </div>
        </header>

        <div class="builder-main">
            <!-- Left Panel - Blocks -->
            <aside class="blocks-panel" id="blocksPanel">
                <div class="panel-header">
                    <h3>Блоки</h3>
                    <input type="text" class="search-input" id="blockSearch" placeholder="Поиск...">
                </div>
                <div class="blocks-categories">
                    <!-- Structure -->
                    <div class="block-category">
                        <div class="category-header" data-category="structure">
                            <i class="fas fa-layer-group"></i>
                            <span>Структура</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="category-blocks">
                            <div class="block-item" draggable="true" data-type="section">
                                <i class="fas fa-square"></i>
                                <span>Секция</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="container">
                                <i class="fas fa-box"></i>
                                <span>Контейнер</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="row">
                                <i class="fas fa-columns"></i>
                                <span>Строка</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="column">
                                <i class="fas fa-grip-lines-vertical"></i>
                                <span>Колонка</span>
                            </div>
                        </div>
                    </div>

                    <!-- Basic -->
                    <div class="block-category">
                        <div class="category-header" data-category="basic">
                            <i class="fas fa-font"></i>
                            <span>Базовые</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="category-blocks">
                            <div class="block-item" draggable="true" data-type="heading">
                                <i class="fas fa-heading"></i>
                                <span>Заголовок</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="text">
                                <i class="fas fa-align-left"></i>
                                <span>Текст</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="image">
                                <i class="fas fa-image"></i>
                                <span>Изображение</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="button">
                                <i class="fas fa-hand-pointer"></i>
                                <span>Кнопка</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="link">
                                <i class="fas fa-link"></i>
                                <span>Ссылка</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="list">
                                <i class="fas fa-list"></i>
                                <span>Список</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="divider">
                                <i class="fas fa-minus"></i>
                                <span>Разделитель</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="spacer">
                                <i class="fas fa-arrows-alt-v"></i>
                                <span>Отступ</span>
                            </div>
                        </div>
                    </div>

                    <!-- Media -->
                    <div class="block-category">
                        <div class="category-header" data-category="media">
                            <i class="fas fa-photo-video"></i>
                            <span>Медиа</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="category-blocks">
                            <div class="block-item" draggable="true" data-type="video">
                                <i class="fas fa-video"></i>
                                <span>Видео</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="gallery">
                                <i class="fas fa-images"></i>
                                <span>Галерея</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="carousel">
                                <i class="fas fa-film"></i>
                                <span>Карусель</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="icon">
                                <i class="fas fa-star"></i>
                                <span>Иконка</span>
                            </div>
                        </div>
                    </div>

                    <!-- Interactive -->
                    <div class="block-category">
                        <div class="category-header" data-category="interactive">
                            <i class="fas fa-mouse-pointer"></i>
                            <span>Интерактив</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="category-blocks">
                            <div class="block-item" draggable="true" data-type="form">
                                <i class="fas fa-envelope"></i>
                                <span>Форма</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="accordion">
                                <i class="fas fa-chevron-down"></i>
                                <span>Аккордеон</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="tabs">
                                <i class="fas fa-folder"></i>
                                <span>Табы</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="modal">
                                <i class="fas fa-window-restore"></i>
                                <span>Модальное окно</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="timer">
                                <i class="fas fa-clock"></i>
                                <span>Таймер</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="modalForm">
                                <i class="fas fa-window-maximize"></i>
                                <span>Модальная форма</span>
                            </div>
                        </div>
                    </div>

                    <!-- Components -->
                    <div class="block-category">
                        <div class="category-header" data-category="components">
                            <i class="fas fa-puzzle-piece"></i>
                            <span>Компоненты</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="category-blocks">
                            <div class="block-item" draggable="true" data-type="navbar">
                                <i class="fas fa-bars"></i>
                                <span>Навигация</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="hero">
                                <i class="fas fa-flag"></i>
                                <span>Hero</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="features">
                                <i class="fas fa-th-large"></i>
                                <span>Преимущества</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="card">
                                <i class="fas fa-id-card"></i>
                                <span>Карточка</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="testimonial">
                                <i class="fas fa-quote-left"></i>
                                <span>Отзыв</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="pricing">
                                <i class="fas fa-tag"></i>
                                <span>Цена</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="counter">
                                <i class="fas fa-sort-numeric-up"></i>
                                <span>Счётчик</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="progress">
                                <i class="fas fa-tasks"></i>
                                <span>Прогресс</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="social">
                                <i class="fas fa-share-alt"></i>
                                <span>Соцсети</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="map">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>Карта</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="table">
                                <i class="fas fa-table"></i>
                                <span>Таблица</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="footer">
                                <i class="fas fa-shoe-prints"></i>
                                <span>Футер</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="program">
                                <i class="fas fa-graduation-cap"></i>
                                <span>Программа</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="speaker">
                                <i class="fas fa-user-tie"></i>
                                <span>Спикер</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="legalFooter">
                                <i class="fas fa-balance-scale"></i>
                                <span>Юр. подвал</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="analytics">
                                <i class="fas fa-chart-bar"></i>
                                <span>Аналитика</span>
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Components -->
                    <div class="block-category">
                        <div class="category-header" data-category="advanced">
                            <i class="fas fa-rocket"></i>
                            <span>Расширенные</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="category-blocks">
                            <div class="block-item" draggable="true" data-type="stickyNavbar">
                                <i class="fas fa-thumbtack"></i>
                                <span>Sticky меню</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="burgerMenu">
                                <i class="fas fa-bars"></i>
                                <span>Бургер меню</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="slider">
                                <i class="fas fa-images"></i>
                                <span>Слайдер</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="cookieConsent">
                                <i class="fas fa-cookie-bite"></i>
                                <span>Cookie баннер</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="backToTop">
                                <i class="fas fa-arrow-up"></i>
                                <span>Наверх</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="fab">
                                <i class="fas fa-plus-circle"></i>
                                <span>FAB кнопка</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="animatedCounter">
                                <i class="fas fa-sort-numeric-up-alt"></i>
                                <span>Анимированный счётчик</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="parallaxSection">
                                <i class="fas fa-layer-group"></i>
                                <span>Параллакс</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="marquee">
                                <i class="fas fa-text-width"></i>
                                <span>Бегущая строка</span>
                            </div>
                        </div>
                    </div>

                    <!-- Code -->
                    <div class="block-category">
                        <div class="category-header" data-category="code">
                            <i class="fas fa-code"></i>
                            <span>Код</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="category-blocks">
                            <div class="block-item" draggable="true" data-type="html">
                                <i class="fab fa-html5"></i>
                                <span>HTML</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="css">
                                <i class="fab fa-css3-alt"></i>
                                <span>CSS</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="js">
                                <i class="fab fa-js"></i>
                                <span>JavaScript</span>
                            </div>
                            <div class="block-item" draggable="true" data-type="widget">
                                <i class="fas fa-plug"></i>
                                <span>Виджет</span>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Canvas -->
            <main class="canvas-wrapper">
                <div class="canvas-container" id="canvasContainer">
                    <div class="canvas" id="canvas" data-viewport="desktop">
                        <div class="canvas-empty" id="canvasEmpty">
                            <i class="fas fa-plus-circle"></i>
                            <p>Перетащите блоки сюда</p>
                            <span>или выберите готовый шаблон</span>
                        </div>
                    </div>
                </div>
            </main>

            <!-- Right Panel - Layers -->
            <aside class="layers-panel" id="layersPanel">
                <div class="panel-header">
                    <h3>Слои</h3>
                </div>
                <div class="layers-content" id="layersContent">
                    <div class="layers-empty">
                        <i class="fas fa-layer-group"></i>
                        <p>Нет добавленных блоков</p>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <!-- Edit Block Modal -->
    <div class="modal" id="editModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 id="editModalTitle">Редактировать блок</h3>
                <button class="modal-close" id="closeEditModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="edit-tabs">
                    <button class="edit-tab active" data-tab="content"><i class="fas fa-font"></i> Контент</button>
                    <button class="edit-tab" data-tab="style"><i class="fas fa-palette"></i> Стиль</button>
                    <button class="edit-tab" data-tab="animation"><i class="fas fa-magic"></i> Анимация</button>
                    <button class="edit-tab" data-tab="action"><i class="fas fa-mouse-pointer"></i> Действие</button>
                    <button class="edit-tab" data-tab="advanced"><i class="fas fa-code"></i> Код</button>
                </div>
                <div class="edit-content" id="editContent">
                    <!-- Settings will be rendered here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn danger" id="deleteBlockBtn">
                    <i class="fas fa-trash"></i> Удалить
                </button>
                <button class="btn" id="cancelEditBtn">Отмена</button>
                <button class="btn primary" id="saveEditBtn">
                    <i class="fas fa-check"></i> Сохранить
                </button>
            </div>
        </div>
    </div>

    <!-- Preview Modal -->
    <div class="modal" id="previewModal">
        <div class="modal-content full">
            <div class="modal-header">
                <h3>Предпросмотр</h3>
                <button class="modal-close" id="closePreview">&times;</button>
            </div>
            <div class="modal-body">
                <iframe id="previewFrame"></iframe>
            </div>
        </div>
    </div>

    <!-- Code Modal -->
    <div class="modal" id="codeModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>Код страницы</h3>
                <div class="code-tabs">
                    <button class="code-tab active" data-tab="html">HTML</button>
                    <button class="code-tab" data-tab="css">CSS</button>
                    <button class="code-tab" data-tab="full">Полный</button>
                </div>
                <button class="modal-close" id="closeCode">&times;</button>
            </div>
            <div class="modal-body">
                <div class="code-content active" id="htmlCode">
                    <pre><code></code></pre>
                </div>
                <div class="code-content" id="cssCode">
                    <pre><code></code></pre>
                </div>
                <div class="code-content" id="fullCode">
                    <pre><code></code></pre>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" id="copyCode">
                    <i class="fas fa-copy"></i> Копировать
                </button>
                <button class="btn primary" id="downloadCode">
                    <i class="fas fa-download"></i> Скачать HTML
                </button>
            </div>
        </div>
    </div>

    <!-- SEO Modal -->
    <div class="modal" id="seoModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-search" style="color: var(--accent); margin-right: 8px;"></i> SEO настройки</h3>
                <button class="modal-close" id="closeSeoModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="edit-section">
                    <h4><i class="fas fa-heading"></i> Основное</h4>
                    <div class="edit-row">
                        <label>Заголовок страницы (Title)</label>
                        <input type="text" class="edit-input" id="seoTitle" placeholder="Название страницы">
                        <p class="edit-hint">Отображается во вкладке браузера и поисковых системах</p>
                    </div>
                    <div class="edit-row">
                        <label>Описание (Meta Description)</label>
                        <textarea class="edit-textarea" id="seoDescription" rows="3" placeholder="Краткое описание страницы для поисковых систем"></textarea>
                        <p class="edit-hint">Рекомендуемая длина: 150-160 символов</p>
                    </div>
                    <div class="edit-row">
                        <label>Ключевые слова</label>
                        <input type="text" class="edit-input" id="seoKeywords" placeholder="ключевое1, ключевое2, ключевое3">
                    </div>
                </div>

                <div class="edit-section">
                    <h4><i class="fab fa-facebook"></i> Open Graph (соцсети)</h4>
                    <div class="edit-row">
                        <label>OG Заголовок</label>
                        <input type="text" class="edit-input" id="seoOgTitle" placeholder="Заголовок для соцсетей">
                    </div>
                    <div class="edit-row">
                        <label>OG Описание</label>
                        <textarea class="edit-textarea" id="seoOgDescription" rows="2" placeholder="Описание для соцсетей"></textarea>
                    </div>
                    <div class="edit-row">
                        <label>OG Изображение</label>
                        <div class="upload-row">
                            <input type="file" id="seoOgImageUpload" accept="image/*" class="edit-file-input">
                            <label for="seoOgImageUpload" class="btn-upload">
                                <i class="fas fa-upload"></i> Загрузить
                            </label>
                        </div>
                        <input type="text" class="edit-input" id="seoOgImage" placeholder="Или вставьте URL изображения" style="margin-top: 8px;">
                        <p class="edit-hint">Рекомендуемый размер: 1200x630px</p>
                    </div>
                </div>

                <div class="edit-section">
                    <h4><i class="fas fa-globe"></i> Favicon</h4>
                    <div class="edit-row">
                        <label>Иконка сайта</label>
                        <div class="upload-row">
                            <input type="file" id="seoFaviconUpload" accept="image/*" class="edit-file-input">
                            <label for="seoFaviconUpload" class="btn-upload">
                                <i class="fas fa-upload"></i> Загрузить
                            </label>
                            <img id="faviconPreview" src="" alt="" style="width:32px;height:32px;display:none;margin-left:12px;border-radius:4px;">
                        </div>
                        <p class="edit-hint">Рекомендуемый размер: 32x32px или 64x64px</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancelSeoBtn">Отмена</button>
                <button class="btn primary" id="saveSeoBtn">
                    <i class="fas fa-check"></i> Сохранить
                </button>
            </div>
        </div>
    </div>

    <!-- Publish Modal -->
    <div class="modal" id="publishModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3><i class="fas fa-cloud-upload-alt" style="color: #8b5cf6; margin-right: 8px;"></i> Опубликовать сайт</h3>
                <button class="modal-close" id="closePublishModal">&times;</button>
            </div>
            <div class="modal-body">
                <p style="color: var(--text-secondary); margin-bottom: 20px;">Выберите платформу для публикации вашего сайта:</p>

                <div class="publish-options">
                    <!-- Netlify Drop -->
                    <div class="publish-option" id="publishNetlify">
                        <div class="publish-option-header">
                            <div class="publish-icon" style="background: linear-gradient(135deg, #00C7B7, #00AD9F);">
                                <i class="fas fa-cloud"></i>
                            </div>
                            <div class="publish-info">
                                <h4>Netlify Drop</h4>
                                <p>Бесплатный хостинг, мгновенная публикация</p>
                            </div>
                            <i class="fas fa-external-link-alt" style="color: var(--text-secondary);"></i>
                        </div>
                        <div class="publish-steps">
                            <ol>
                                <li>Скачайте сайт как ZIP архив</li>
                                <li>Перейдите на <a href="https://app.netlify.com/drop" target="_blank">app.netlify.com/drop</a></li>
                                <li>Перетащите ZIP файл в область загрузки</li>
                                <li>Готово! Получите ссылку на сайт</li>
                            </ol>
                        </div>
                    </div>

                    <!-- Vercel -->
                    <div class="publish-option" id="publishVercel">
                        <div class="publish-option-header">
                            <div class="publish-icon" style="background: #000;">
                                <i class="fas fa-triangle" style="transform: rotate(180deg);"></i>
                            </div>
                            <div class="publish-info">
                                <h4>Vercel</h4>
                                <p>Быстрый хостинг от создателей Next.js</p>
                            </div>
                            <i class="fas fa-external-link-alt" style="color: var(--text-secondary);"></i>
                        </div>
                        <div class="publish-steps">
                            <ol>
                                <li>Скачайте сайт как ZIP и распакуйте</li>
                                <li>Создайте репозиторий на GitHub</li>
                                <li>Загрузите файлы в репозиторий</li>
                                <li>Подключите репозиторий к <a href="https://vercel.com" target="_blank">Vercel</a></li>
                            </ol>
                        </div>
                    </div>

                    <!-- GitHub Pages -->
                    <div class="publish-option" id="publishGithub">
                        <div class="publish-option-header">
                            <div class="publish-icon" style="background: #24292e;">
                                <i class="fab fa-github"></i>
                            </div>
                            <div class="publish-info">
                                <h4>GitHub Pages</h4>
                                <p>Бесплатный хостинг для статических сайтов</p>
                            </div>
                            <i class="fas fa-external-link-alt" style="color: var(--text-secondary);"></i>
                        </div>
                        <div class="publish-steps">
                            <ol>
                                <li>Создайте репозиторий на GitHub</li>
                                <li>Загрузите index.html и assets</li>
                                <li>Settings → Pages → Source: main branch</li>
                                <li>Сайт доступен по адресу username.github.io/repo</li>
                            </ol>
                        </div>
                    </div>

                    <!-- Custom hosting -->
                    <div class="publish-option" id="publishCustom">
                        <div class="publish-option-header">
                            <div class="publish-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                <i class="fas fa-server"></i>
                            </div>
                            <div class="publish-info">
                                <h4>Свой хостинг</h4>
                                <p>FTP/SFTP загрузка на любой хостинг</p>
                            </div>
                            <i class="fas fa-external-link-alt" style="color: var(--text-secondary);"></i>
                        </div>
                        <div class="publish-steps">
                            <ol>
                                <li>Скачайте сайт как ZIP архив</li>
                                <li>Распакуйте архив</li>
                                <li>Загрузите файлы через FTP-клиент (FileZilla)</li>
                                <li>Укажите index.html как главную страницу</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancelPublishBtn">Закрыть</button>
                <button class="btn primary" id="downloadForPublish">
                    <i class="fas fa-download"></i> Скачать ZIP
                </button>
            </div>
        </div>
    </div>

    <!-- Theme Modal -->
    <div class="modal" id="themeModal">
        <div class="modal-content" style="max-width: 650px;">
            <div class="modal-header">
                <h3><i class="fas fa-palette" style="color: var(--accent); margin-right: 8px;"></i> Тема оформления</h3>
                <button class="modal-close" id="closeThemeModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="edit-section">
                    <h4><i class="fas fa-swatchbook"></i> Пресеты</h4>
                    <div id="themePresets" style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;"></div>
                </div>

                <div class="edit-section">
                    <h4><i class="fas fa-fill-drip"></i> Цвета</h4>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
                        <div class="edit-row">
                            <label>Основной</label>
                            <div class="edit-color">
                                <input type="color" id="themePrimary" value="#3b82f6">
                                <input type="text" class="edit-input" id="themePrimaryText" value="#3b82f6">
                            </div>
                        </div>
                        <div class="edit-row">
                            <label>Вторичный</label>
                            <div class="edit-color">
                                <input type="color" id="themeSecondary" value="#10b981">
                                <input type="text" class="edit-input" id="themeSecondaryText" value="#10b981">
                            </div>
                        </div>
                        <div class="edit-row">
                            <label>Акцент</label>
                            <div class="edit-color">
                                <input type="color" id="themeAccent" value="#f59e0b">
                                <input type="text" class="edit-input" id="themeAccentText" value="#f59e0b">
                            </div>
                        </div>
                        <div class="edit-row">
                            <label>Текст</label>
                            <div class="edit-color">
                                <input type="color" id="themeText" value="#1e293b">
                                <input type="text" class="edit-input" id="themeTextText" value="#1e293b">
                            </div>
                        </div>
                        <div class="edit-row">
                            <label>Текст (вторичный)</label>
                            <div class="edit-color">
                                <input type="color" id="themeTextSecondary" value="#64748b">
                                <input type="text" class="edit-input" id="themeTextSecondaryText" value="#64748b">
                            </div>
                        </div>
                        <div class="edit-row">
                            <label>Фон</label>
                            <div class="edit-color">
                                <input type="color" id="themeBg" value="#ffffff">
                                <input type="text" class="edit-input" id="themeBgText" value="#ffffff">
                            </div>
                        </div>
                        <div class="edit-row">
                            <label>Фон (вторичный)</label>
                            <div class="edit-color">
                                <input type="color" id="themeBgSecondary" value="#f8fafc">
                                <input type="text" class="edit-input" id="themeBgSecondaryText" value="#f8fafc">
                            </div>
                        </div>
                        <div class="edit-row">
                            <label>Границы</label>
                            <div class="edit-color">
                                <input type="color" id="themeBorder" value="#e2e8f0">
                                <input type="text" class="edit-input" id="themeBorderText" value="#e2e8f0">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="edit-section">
                    <h4><i class="fas fa-text-height"></i> Типографика</h4>
                    <div class="edit-row">
                        <label>Шрифт</label>
                        <select class="edit-select" id="themeFontFamily">
                            <option value="Inter">Inter</option>
                            <option value="Roboto">Roboto</option>
                            <option value="Open Sans">Open Sans</option>
                            <option value="Montserrat">Montserrat</option>
                            <option value="Nunito">Nunito</option>
                            <option value="Poppins">Poppins</option>
                            <option value="Raleway">Raleway</option>
                            <option value="Playfair Display">Playfair Display</option>
                            <option value="Manrope">Manrope</option>
                            <option value="Space Grotesk">Space Grotesk</option>
                        </select>
                    </div>
                    <div class="edit-row">
                        <label>Скругление углов</label>
                        <select class="edit-select" id="themeBorderRadius">
                            <option value="0px">Без скругления</option>
                            <option value="4px">Минимальное (4px)</option>
                            <option value="8px">Среднее (8px)</option>
                            <option value="12px">Большое (12px)</option>
                            <option value="16px">Очень большое (16px)</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancelThemeBtn">Отмена</button>
                <button class="btn primary" id="saveThemeBtn">
                    <i class="fas fa-check"></i> Применить тему
                </button>
            </div>
        </div>
    </div>

    <!-- AI Generation Modal -->
    <div class="modal" id="aiModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3><i class="fas fa-magic" style="color: #f59e0b; margin-right: 8px;"></i> AI генерация лендинга</h3>
                <button class="modal-close" id="closeAiModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="aiForm">
                    <div class="ai-form-grid">
                        <div class="edit-row">
                            <label>Ваша ниша *</label>
                            <input type="text" class="edit-input" id="aiNiche" required placeholder="Например: фитнес, образование, IT">
                        </div>
                        <div class="edit-row">
                            <label>Продукт *</label>
                            <input type="text" class="edit-input" id="aiProduct" required placeholder="Онлайн-курс, консультация, товар...">
                        </div>
                        <div class="edit-row full-width">
                            <label>Описание продукта *</label>
                            <textarea class="edit-textarea" id="aiProductDesc" rows="3" required placeholder="Подробно опишите что вы продаёте..."></textarea>
                        </div>
                        <div class="edit-row full-width">
                            <label>Описание аудитории *</label>
                            <textarea class="edit-textarea" id="aiAudience" rows="2" required placeholder="Кто ваши клиенты? Возраст, интересы, боли..."></textarea>
                        </div>
                        <div class="edit-row full-width">
                            <label>Главное предложение (УТП) *</label>
                            <input type="text" class="edit-input" id="aiOffer" required placeholder="Почему клиент должен выбрать именно вас?">
                        </div>
                        <div class="edit-row">
                            <label>Тон коммуникации</label>
                            <select class="edit-select" id="aiTone">
                                <option>Профессиональный</option>
                                <option>Дружелюбный</option>
                                <option>Премиальный</option>
                                <option>Энергичный</option>
                            </select>
                        </div>
                        <div class="edit-row">
                            <label>Цветовая схема</label>
                            <select class="edit-select" id="aiColors">
                                <option value="blue">Синяя</option>
                                <option value="green">Зелёная</option>
                                <option value="dark">Тёмная</option>
                                <option value="warm">Тёплая</option>
                                <option value="purple">Фиолетовая</option>
                            </select>
                        </div>
                    </div>
                </form>
                <div id="aiProgress" style="display:none">
                    <div class="ai-loading"><i class="fas fa-spinner fa-spin"></i> Генерация лендинга...</div>
                    <div class="ai-progress-bar"><div class="ai-progress-fill"></div></div>
                </div>
                <div id="aiError" style="display:none" class="ai-error"></div>
            </div>
            <div class="modal-footer">
                <button class="btn" id="aiCancelBtn">Отмена</button>
                <button class="btn primary" id="aiGenerateSubmit"><i class="fas fa-magic"></i> Сгенерировать</button>
            </div>
        </div>
    </div>

    <!-- AI Block Editor Dialog -->
    <div class="modal" id="aiBlockModal">
        <div class="modal-content ai-dialog-modal" style="max-width: 600px;">
            <div class="modal-header">
                <h2><i class="fas fa-magic" style="background: linear-gradient(135deg, #f59e0b, #ea580c); -webkit-background-clip: text; -webkit-text-fill-color: transparent;"></i> AI Редактор блока</h2>
                <button class="modal-close" id="aiBlockClose">&times;</button>
            </div>
            <div class="modal-body" style="padding: 0;">
                <div class="ai-block-info" id="aiBlockInfo" style="padding: 15px; background: #f8fafc; border-bottom: 1px solid #e2e8f0;">
                    <span class="block-type-badge"><i class="fas fa-cube"></i> <span id="aiBlockType">Блок</span></span>
                </div>
                <div class="ai-chat-container" style="height: 350px; display: flex; flex-direction: column;">
                    <div class="ai-chat-messages" id="aiChatMessages" style="flex: 1; overflow-y: auto; padding: 15px;">
                        <div class="ai-message assistant">
                            <div class="message-avatar"><i class="fas fa-robot"></i></div>
                            <div class="message-content">
                                Привет! Я помогу отредактировать этот блок. Опишите, что вы хотите изменить:
                                <ul style="margin: 10px 0 0 0; padding-left: 20px; opacity: 0.8;">
                                    <li>Изменить текст или заголовок</li>
                                    <li>Поменять стили и цвета</li>
                                    <li>Добавить или удалить элементы</li>
                                    <li>Улучшить контент с помощью AI</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="ai-chat-input" style="padding: 15px; border-top: 1px solid #e2e8f0; background: #f8fafc;">
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="aiChatInput" class="edit-input" placeholder="Опишите изменения..." style="flex: 1;">
                            <button class="btn primary" id="aiChatSend" style="background: linear-gradient(135deg, #f59e0b, #ea580c); border: none;">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                        <div class="ai-quick-actions" style="display: flex; gap: 8px; margin-top: 10px; flex-wrap: wrap;">
                            <button class="ai-quick-btn" data-prompt="Сделай текст более продающим">🎯 Продающий текст</button>
                            <button class="ai-quick-btn" data-prompt="Измени цвета на более яркие">🎨 Яркие цвета</button>
                            <button class="ai-quick-btn" data-prompt="Добавь больше отступов">📐 Больше отступов</button>
                            <button class="ai-quick-btn" data-prompt="Сократи текст">✂️ Сократить</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <style>
        /* AI Block Dialog Styles */
        .ai-dialog-modal .block-type-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: linear-gradient(135deg, #f59e0b20, #ea580c20);
            border: 1px solid #f59e0b40;
            border-radius: 20px;
            font-size: 13px;
            color: #ea580c;
            font-weight: 500;
        }
        .ai-chat-messages {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .ai-message {
            display: flex;
            gap: 10px;
            max-width: 85%;
        }
        .ai-message.user {
            align-self: flex-end;
            flex-direction: row-reverse;
        }
        .ai-message .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        .ai-message.assistant .message-avatar {
            background: linear-gradient(135deg, #f59e0b, #ea580c);
            color: white;
        }
        .ai-message.user .message-avatar {
            background: #6366f1;
            color: white;
        }
        .ai-message .message-content {
            padding: 10px 14px;
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.5;
        }
        .ai-message.assistant .message-content {
            background: #f1f5f9;
            color: #334155;
            border-bottom-left-radius: 4px;
        }
        .ai-message.user .message-content {
            background: #6366f1;
            color: white;
            border-bottom-right-radius: 4px;
        }
        .ai-quick-btn {
            padding: 6px 12px;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .ai-quick-btn:hover {
            background: #f1f5f9;
            border-color: #f59e0b;
            color: #ea580c;
        }
        .ai-message.loading .message-content {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .ai-typing-indicator {
            display: flex;
            gap: 4px;
        }
        .ai-typing-indicator span {
            width: 6px;
            height: 6px;
            background: #94a3b8;
            border-radius: 50%;
            animation: typing 1.4s infinite both;
        }
        .ai-typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .ai-typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-4px); }
        }
    </style>

    <script src="builder.js"></script>
</body>
</html>
